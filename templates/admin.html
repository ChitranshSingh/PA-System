<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PA System - Admin Dashboard</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="nav-brand">ğŸ”Š PA System</a>
            <div class="nav-links">
                <span style="margin-right: 15px; color: #666;">ğŸ‘¤ {{ username }}</span>
                <a href="/admin" class="active">Admin</a>
                <a href="/client">Client</a>
                <a href="/history">History</a>
                <a href="/logout" style="color: #dc3545;">Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="admin-layout">
            <!-- Left Panel - Announcement Form -->
            <div class="card">
                <h1 class="card-title">ğŸ“¢ Broadcast Announcement</h1>
                
                <div class="status-bar" id="statusBar">
                    <span class="status-indicator" id="statusIndicator">ğŸŸ¡</span>
                    <span id="statusText">Connecting...</span>
                </div>

                <div class="form-group">
                    <label>Announcement Text</label>
                    <textarea 
                        id="announcementText" 
                        rows="5" 
                        placeholder="Type your announcement here...&#10;&#10;Example: Please proceed to Gate 3 for evacuation."></textarea>
                    <div class="char-count">
                        <span id="charCount">0</span> characters
                    </div>
                </div>

                <div class="form-group">
                    <label>Priority Level</label>
                    <div class="priority-selector">
                        <label class="priority-option">
                            <input type="radio" name="priority" value="normal" checked>
                            <span class="priority-badge normal">ğŸŸ¢ Normal</span>
                        </label>
                        <label class="priority-option">
                            <input type="radio" name="priority" value="warning">
                            <span class="priority-badge warning">ğŸŸ¡ Warning</span>
                        </label>
                        <label class="priority-option">
                            <input type="radio" name="priority" value="emergency">
                            <span class="priority-badge emergency">ğŸ”´ Emergency</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label>Target Languages</label>
                    <div class="language-grid">
                        {% for code, lang in languages.items() %}
                        <label class="language-option">
                            <input type="checkbox" name="language" value="{{ code }}" 
                                   {% if code in ['en', 'hi', 'es', 'fr'] %}checked{% endif %}>
                            <span class="language-badge">
                                <span class="flag">{{ lang.flag }}</span>
                                <span class="lang-name">{{ lang.name }}</span>
                            </span>
                        </label>
                        {% endfor %}
                    </div>
                    <div class="lang-count">
                        <span id="langCount">4</span> languages selected
                    </div>
                </div>

                <button id="broadcastBtn" class="btn btn-primary btn-large">
                    <span class="btn-icon">ğŸ“¢</span>
                    <span>Broadcast Announcement</span>
                </button>

                <div id="successMessage" class="alert alert-success" style="display: none;">
                    âœ… Announcement broadcasted successfully!
                </div>

                <div id="errorMessage" class="alert alert-error" style="display: none;">
                    âŒ <span id="errorText"></span>
                </div>
            </div>

            <!-- Right Panel - QR Code & Stats -->
            <div class="side-panel">
                <div class="card">
                    <h3>ğŸ“± Client Access</h3>
                    <p class="info-text">Scan QR code to access client display on mobile devices</p>
                    <div class="qr-container">
                        <img src="/{{ qr_path }}" alt="QR Code" class="qr-code">
                    </div>
                    <div class="url-box">
                        <code id="clientUrl">{{ client_url }}</code>
                        <button onclick="copyUrl()" class="btn-copy" title="Copy URL">ğŸ“‹</button>
                    </div>
                </div>

                <div class="card">
                    <h3>ğŸ“Š Broadcast Stats</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-value" id="totalBroadcasts">0</div>
                            <div class="stat-label">Total Broadcasts</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="connectedClients">0</div>
                            <div class="stat-label">Connected Clients</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="lastBroadcast">Never</div>
                            <div class="stat-label">Last Broadcast</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3>ğŸ’¡ Quick Tips</h3>
                    <ul class="tips-list">
                        <li>ğŸ¯ Keep messages clear and concise</li>
                        <li>ğŸ”´ Use Emergency only for critical alerts</li>
                        <li>ğŸŒ Select relevant languages for your audience</li>
                        <li>ğŸ”Š Audio plays automatically on client devices</li>
                        <li>ğŸ“œ View all broadcasts in History page</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/admin.js"></script>
</body>
</html>
